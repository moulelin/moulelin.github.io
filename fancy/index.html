<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>love line with Mrs.Fancy</title>

<style type="text/css">
@font-face {
    font-family: digit;
    src: url('digital-7_mono.ttf') format("truetype");
}
</style>

<link href="css/default.css" type="text/css" rel="stylesheet">
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/garden.js"></script>
<script type="text/javascript" src="js/functions.js"></script>
<style>
    #loveHeart {
        background-image: url('background.jpg'); /* 设置背景图像 */
    }
    #messages {
        text-shadow: 2px 2px 8px #000; /* X偏移, Y偏移, 阴影模糊半径, 阴影颜色 */
        color: white; /* 白色文字 */
        font-size: 30px;
    }
    #dog {
        position: absolute;
        width: 100px;
        height: 100px;
        background-image: url('dog2.gif'); /* Replace with the path to your dog image */
        background-size: contain;
        background-repeat: no-repeat;
    }
    #feedMessage {
        position: absolute;
        display: none;
        color: red;
        font-size: 20px;
        font-weight: bold;
    }
</style>
</head>

<body>
    <audio id="audioPlayer" autoplay>
        <source src="music/lover.mp3" type="audio/mp3">
        您的浏览器不支持 audio 标签。
    </audio>

    <script>
        // 这里列出你的music文件夹中的音乐文件
        const musicList = [
            'music/Canon.mp3',
            'music/lover.mp3',
            'music/love.mp3',
            'music/night.mp3'
        ];

        let musicIndex = 0; // 始终从列表的第一首歌曲beginning播放
        const audioPlayer = document.getElementById('audioPlayer');
        audioPlayer.src = musicList[musicIndex]; // 设置播放源

        // 静音播放然后取消静音
        audioPlayer.muted = true;
        audioPlayer.play().then(() => {
            audioPlayer.muted = false;
        }).catch((error) => {
            console.log("自动播放被阻止，等待用户交互", error);
        });

        // 监听音乐播放close事件，自动切换到下一首歌
        audioPlayer.addEventListener('ended', playNextSong);

        function playNextSong() {
            musicIndex = (musicIndex + 1) % musicList.length; // 更新音乐索引，循环播放列表
            audioPlayer.src = musicList[musicIndex]; // 更改音乐源
            audioPlayer.play(); // 自动播放下一首
        }

        // 用户交互事件处理
        document.body.addEventListener('click', function() {
            audioPlayer.play().catch((error) => {
                console.log("播放失败", error);
            });
        });

        // Dog pet movement
        let dogX = Math.random() * window.innerWidth;
        let dogY = Math.random() * window.innerHeight;
        let speedX = 2 + Math.random() * 3; // 随机生成水平速度
        let speedY = 2 + Math.random() * 3; // 随机生成垂直速度

        function moveDog() {
            const dog = document.getElementById('dog');
            const width = window.innerWidth - dog.offsetWidth;
            const height = window.innerHeight - dog.offsetHeight;

            dogX += speedX;
            dogY += speedY;

            // 水平方向反弹逻辑
            if (dogX >= width || dogX <= 0) {
                speedX = -speedX; // 水平方向反弹
                // 判断dog的方向并调整背景图像
                if (speedX > 0) {
                    dog.style.transform = 'scaleX(1)'; // 正向图像
                } else {
                    dog.style.transform = 'scaleX(-1)'; // 反向图像
                }
            }

            // 垂直方向反弹逻辑
            if (dogY >= height || dogY <= 0) {
                speedY = -speedY; // 垂直方向反弹
            }

            dog.style.left = dogX + 'px';
            dog.style.top = dogY + 'px';
        }

        setInterval(moveDog, 50);

        // Feeding functionality
        let feedCount = 0;

        function feedDog() {
            const feedMessage = document.getElementById('feedMessage');
            const dog = document.getElementById('dog');

            if (feedCount >= 5) {
                feedMessage.textContent = '吃饱啦，别喂啦';
            } else {
                feedMessage.textContent = '投食+1';
                feedCount++;
            }
            feedMessage.style.left = dogX + 'px';
            feedMessage.style.top = (dogY - 20) + 'px';
            feedMessage.style.display = 'block';
            setTimeout(function() {
                feedMessage.style.display = 'none';
            }, 1000); // Hide the message after 1 second
        }

        document.addEventListener('DOMContentLoaded', function() {
            const dog = document.getElementById('dog');
            dog.addEventListener('click', feedDog);
        });
    </script>

<div id="mainDiv">
    <div id="content">
        <div id="code">
            我们在一起的每一刻!<br />
            都让我感受到无尽的喜悦和满足<br />
            因为你就是我生命中最重要的存在<br />
            你点亮了我的世界<br />
            <span class="keyword">我深深地爱着你</span><br /><br />
            范洁心，谢谢你出现在我的生活里<br />
            你让我相信爱情的美好<br />
            <span class="keyword">与你共度的每一天都是珍贵的</span><br /><br />
            未来的路，我们一起走<br />
            <span class="keyword">有你的陪伴</span>：<br /><br />
            <br />
            <span class="keyword">一切都充满了希望</span><br /><br />
            <hr />
            <span class="keyword">You are my everything:</span><br />
            Mrs.Fancy<br />
            <span class="keyword"> I love you more each day! </span><br />
            -- Moral<br />
        </div>
        <div id="loveHeart">
            <canvas id="garden"></canvas>
            <div id="words">
                <div id="messages">
                    永恒的爱，铭刻于心...
                    <div id="elapseClock"></div>
                </div>
            </div>
        </div>
    </div>
    <div id="dog"></div>
    <div id="feedMessage"></div>
</div>
    <script type="text/javascript">
        var offsetX = $("#loveHeart").width() / 2;
        var offsetY = $("#loveHeart").height() / 2 - 55;
        var together = new Date();

        together.setFullYear(2024, 3, 1);
        together.setHours(12);
        together.setMinutes(0);
        together.setSeconds(0);
        together.setMilliseconds(0);

        if (!document.createElement('canvas').getContext) {
            var msg = document.createElement("div");
            msg.id = "errorMsg";
            msg.innerHTML = "Your browser doesn't support HTML5!<br/>Recommend use Chrome 14+/IE 9+/Firefox 7+/Safari 4+";
            document.body.appendChild(msg);
            $("#code").css("display", "none")
            $("#copyright").css("position", "absolute");
            $("#copyright").css("bottom", "10px");
            document.execCommand("stop");
        } else {
            setTimeout(function () {
                startHeartAnimation();
            }, 5000);

            timeElapse(together);
            setInterval(function () {
                timeElapse(together);
            }, 500);

            adjustCodePosition();
            $("#code").typewriter();
        }
    </script>
    <div style="text-align:center;clear:both">
        <p>Made for Mrs.Fancy, made by <a href="https://github.com/moulelin" target="_blank">Moral</a></p>
        <p>Copyright © 2024 - 2025. All Rights Reserved. Designed by <a href="https://github.com/moulelin" target="_blank">Moral</a></p>
    </div>
</body>
</html>
